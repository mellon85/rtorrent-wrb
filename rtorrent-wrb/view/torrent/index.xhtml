<small>version #{@version}/#{@library}</small><br/>

<h1>Torrent List: #{@view_name}</h1>

<script language="javascript">
function priority_up(id) {
    $.get("/torrent/torrent_priority_up/"+id,{}
        ,function(d) {
            $("#prio"+id).text(d);
        },"text");
}

function priority_down(id) {
    $.get("/torrent/torrent_priority_down/"+id,{}
        ,function(d) {
            $("#prio"+id).text(d);
        },"text");
}
</script>

<p><div id="tabs">
    <a href="#{Rs(:index)}">All</a>
    <a href="#{Rs(:completed)}">Completed</a>
    <a href="#{Rs(:downloading)}">Downloading</a>
    <a href="#{Rs(:seeding)}">Seeding</a>
</div></p>

</p><div id="torrents">
<?r if @torrents.empty? then ?>
<h3>No torrents</h3>
<?r else ?>

<script language="javascript">
function change_status(id) {
    $.post("/torrent/togglePause/"+id,{}
        ,function(data){
           $.get("/torrent/button_for_status/"+id,{},function(button) {
                $('#'+id).attr("src","/images/button_"+button+".png");
            },"text")
        });
}
</script>

<table border="0" valign="middle">
  <tr><th>Name</th><th>Size</th><th>Downloaded</th><th>Uploaded</th>
      <th>Download</th><th>Upload</th><th>Ratio</th><th>Priority</th>
        </tr>

<?r @torrents.each do |x| ?>
<tr><th align="left">
    <a onclick='change_status(\"#{x.torrent_id}\")'>
        <img width="20" height="20" border="0" id="#{x.torrent_id}"
            src="/images/button_#{button_for_status(x.torrent_id)}.png"/></a>

        <a href="/torrent/show/#{x.torrent_id}">#{x.name}</a></th>
    <th>#{convert_bytes(x.size)}</th>
    <th>#{convert_bytes(x.downloaded)}</th>
    <th>#{convert_bytes(x.uploaded)}</th>
    <th>#{convert_bytes(x.down)}</th>
    <th>#{convert_bytes(x.up)}</th>
    <th>#{print_ratio(x.ratio)}</th>
    <th><div id="prio#{x.torrent_id}">#{print_torrent_priority(x.priority)}</div></th>
    <th>
<a onclick="priority_up('#{x.torrent_id}')">+</a>
      </th>
      <th>
<a onclick="priority_down('#{x.torrent_id}')">-</a>
      </th>
</tr>
<?r end ?>
</table>
<?r end ?>
</div></p>

<p>
<a href="#{Rs(:logout)}">logout</a>
<a href="#{Rs(:config)}">configure</a>
<a href="#{Rs(:send_torrent)}">send torrent</a>
</p>
